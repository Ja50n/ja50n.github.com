<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>Ubuntu中Sublime Text 3中文输入解决方法 - Ulink</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/favicon.ico"></head><body><div class="post-header"><img class="background" src="/default_images/post_background.jpg"><div class="post-title"><h1 class="title">Ubuntu中Sublime Text 3中文输入解决方法</h1><ul class="meta"><li><i class="icon icon-author"></i>Jason Qiu</li><li><i class="icon icon-clock"></i>3 Minutes</li><li><i class="icon icon-calendar"></i>2015年7月7日</li></ul></div></div><div class="article-content"><p>本文整理自百度经验，作者<a href="http://jingyan.baidu.com/user/npublic?un=LunnLew" target="_blank" rel="external">LunnLew</a>，<a href="http://jingyan.baidu.com/article/f3ad7d0ff8731609c3345b3b.html" target="_blank" rel="external">原文链接</a>。解决Ubuntu系统中使用Sublime Text 3时无法切换到搜狗输入法输入中文的问题。</p>
<a id="more"></a>
<p>环境与工具:</p>
<ul>
<li>系统：Ubuntu14.04</li>
<li>输入法：搜狗输入法 for Linux</li>
<li>编辑器：Sublime text 3</li>
</ul>
<p><br><br><br><br><br></p>
<h5 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h5><p>保存下面的代码到文件<code>sublime_imfix.c</code> (位于~目录)</p>
<pre><code>#include &lt;gtk/gtkimcontext.h&gt;
void gtk_im_context_set_client_window (GtkIMContext *context,GdkWindow *window)
{
GtkIMContextClass *klass;
g_return_if_fail (GTK_IS_IM_CONTEXT (context));
klass = GTK_IM_CONTEXT_GET_CLASS (context);
if (klass-&gt;set_client_window)
    klass-&gt;set_client_window (context, window);
    g_object_set_data(G_OBJECT(context),&quot;window&quot;,window);
if(!GDK_IS_WINDOW (window))
    return;
int width = gdk_window_get_width(window);
int height = gdk_window_get_height(window);
if(width != 0 &amp;&amp; height != 0)
    gtk_im_context_focus_in(context);
}
</code></pre><p><br><br><br><br><br></p>
<h5 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h5><p>将上一步的代码编译成共享库<code>libsublime-imfix.so</code>，命令</p>
<p>cd ~<br>gcc -shared -o libsublime-imfix.so sublime_imfix.c  <code>pkg-config --libs --cflags gtk+-2.0</code> -fPIC</p>
<p>注意：运行此命令前,可能需要先安装<code>gtk+-2.0</code>。</p>
<p><br><br><br><br><br></p>
<h5 id="步骤三"><a href="#步骤三" class="headerlink" title="步骤三"></a>步骤三</h5><p>将<code>libsublime-imfix.so</code>拷贝到sublime_text所在文件夹</p>
<pre><code>sudo mv libsublime-imfix.so /opt/sublime_text/
</code></pre><p>修改文件<code>/usr/bin/subl</code>的内容</p>
<pre><code>sudo gedit /usr/bin/subl
</code></pre><p>将</p>
<blockquote>
<p><em>exec /opt/sublime_text/sublime_text “$@”</em></p>
</blockquote>
<p>修改为</p>
<blockquote>
<p><em>LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text “$@”</em></p>
</blockquote>
<p>此时，在命令中执行 <code>subl</code> 将可以使用搜狗for linux的中文输入。</p>
<p><br><br><br><br><br></p>
<h5 id="步骤四"><a href="#步骤四" class="headerlink" title="步骤四"></a>步骤四</h5><p>为了使用鼠标右键打开文件及点击图标打开sublime时能够使用中文输入，还需要修改文件<code>sublime_text.desktop</code>的内容。</p>
<p>命令</p>
<pre><code>sudo gedit /usr/share/applications/sublime_text.desktop
</code></pre><p>将<code>[Desktop Entry]</code>中的字符串</p>
<blockquote>
<p><em>Exec=/opt/sublime_text/sublime_text %F</em></p>
</blockquote>
<p>修改为</p>
<blockquote>
<p><em>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text %F”</em></p>
</blockquote>
<p>将<code>[Desktop Action Window]</code>中的字符串</p>
<blockquote>
<p><em>Exec=/opt/sublime_text/sublime_text -n</em></p>
</blockquote>
<p>修改为</p>
<blockquote>
<p><em>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text -n”</em></p>
</blockquote>
<p>将<code>[Desktop Action Document]</code>中的字符串</p>
<blockquote>
<p><em>Exec=/opt/sublime_text/sublime_text –command new_file</em></p>
</blockquote>
<p>修改为</p>
<blockquote>
<p><em>Exec=bash -c “LD_PRELOAD=/opt/sublime_text/libsublime-imfix.so exec /opt/sublime_text/sublime_text –command new_file”</em></p>
</blockquote>
<p><strong>注意：</strong></p>
<p>修改时请注意双引号<code>&quot;&quot;</code>,否则会导致不能打开带有空格文件名的文件。</p>
<p>此处仅修改了<code>/usr/share/applications/sublime-text.desktop</code>，但可以正常使用了。</p>
<p><code>opt/sublime_text/</code>目录下的<code>sublime-text.desktop</code>可以修改，也可不修改。</p>
<p>经过以上步骤我们能在Sublime中输入中文了。</p>
</div><div class="article-meta"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime-Text/">Sublime Text</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/">Ubuntu</a><span class="tag-list-count">1</span></li></ul></div><div class="categories"><i class="icon icon-category"></i><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Method/">Method</a><span class="category-list-count">4</span></li></ul></div></div><div class="article-comment"><div class="ds-thread" id="ds-thread" data-thread-key="ciwj8ru3c000ry8v48j29iauz" data-title="Ubuntu中Sublime Text 3中文输入解决方法" data-url="http://ulink-el.com/2015/07/07/2015-07-07-ubuntu-sublime-text-sougou-input/" site-name="Ja50n"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2015/07/07/2015-07-07-workflow/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2015/06/20/2015-06-20-about-kids/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="http://github.com/Ja50n" title="GitHub" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/TINE59" title="Weibo" target="_blank"><i class="icon icon-weibo"></i></a></li><li><a href="https://www.facebook.com/profile.php?id=100004706853806" title="facebook" target="_blank"><i class="icon icon-facebook"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2016 Ulink<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small><small>, THEME BY <a href="https://github.com/BoizZ/hexo-theme-laughing" target="_blank">LAUGHING</a></small></p></div></div></body></html>